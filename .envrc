# shellcheck shell=bash
# direnv configuration for devkit
# Install direnv: brew install direnv (macOS) or apt install direnv (Linux)
# Setup shell: eval "$(direnv hook zsh)" in ~/.zshrc or ~/.bashrc
# Allow this file: direnv allow

# Use Python from mise if available
if has mise; then
  layout python python3.13
fi

# Load environment variables from .env if it exists
if [[ -f .env ]]; then
  dotenv
fi

# Export devkit paths
export DEVKIT_ROOT
DEVKIT_ROOT="$(pwd)"
export DEVKIT_LOGS="${HOME}/.devkit/logs"
export DEVKIT_CONFIG="${HOME}/.devkit/config"

# Create required directories
mkdir -p "${DEVKIT_LOGS}" "${DEVKIT_CONFIG}"

# Python environment
export PYTHONPATH="${DEVKIT_ROOT}:${PYTHONPATH}"

# Add local scripts to PATH
PATH_add "${DEVKIT_ROOT}/scripts"

# Add .local/bin for pip-installed tools
PATH_add "${HOME}/.local/bin"

# Show devkit info on cd
echo "ðŸ“¦ devkit environment loaded"
echo "   Root: ${DEVKIT_ROOT}"
echo "   Python: $(python3 --version 2>&1 | cut -d' ' -f2)"
